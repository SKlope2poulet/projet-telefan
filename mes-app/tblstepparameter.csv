MClass;MNo;SqlString;QueryParameterList;AnswerParameterList;Description;Short;MaxRecords
0;0;NULL;0;0;no message;no message;1
1;1;;0;26;get the actuall version number of MES4;GetVersion;1
10;1;;0;0;book a produced part to MES;PartProduced;1
10;10;#Aux1Int;19;0;Message from PLC to MES4 with Message Level and Text with 128 signs;Message;1
11;1;#ResourceID;0;17;get the actual State for a Resource;GetResourceState;1
100;1;SELECT tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrderPos.MainOPos, tblOrder.CNo, tblOrderPos.PNo, tblStep.ErrorStepNo
FROM (tblOrder INNER JOIN tblOrderPos ON tblOrder.ONo = tblOrderPos.ONo) INNER JOIN tblStep ON (tblOrderPos.StepNo = tblStep.StepNo) AND (tblOrderPos.StepNo = tblStep.StepNo) AND (tblOrderPos.OPos = tblStep.OPos) AND (tblOrderPos.ONo = tblStep.ONo)
WHERE (((tblOrderPos.ResourceID)=#ResourceID) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<10) AND ((tblOrder.Enabled)=True) AND ((tblOrderPos.subOrderBlocked)=False))
ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos;;0;1;get next operation for resource;GetOpForRsc;1
100;2;SELECT tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrderPos.MainOPos, tblOrder.CNo, tblOrderPos.PNo, tblStep.ErrorStepNo 

FROM (tblPallet INNER JOIN (tblOrder INNER JOIN tblOrderPos ON tblOrder.ONo = tblOrderPos.ONo) ON (tblPallet.OPos = tblOrderPos.OPos) AND (tblPallet.ONo = tblOrder.ONo)) INNER JOIN tblStep ON (tblOrderPos.StepNo = tblStep.StepNo) AND (tblOrderPos.StepNo = tblStep.StepNo) AND (tblOrderPos.OPos = tblStep.OPos) AND (tblOrderPos.ONo = tblStep.ONo)

WHERE (((tblOrderPos.ResourceID)=#ResourceID) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<10) AND ((tblOrder.Enabled)=True) AND ((tblOrderPos.subOrderBlocked)=False) AND ((tblPallet.PalletID)=#PalletID)) 

ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos;;0;1;get next operation for pallet
;GetOpForPallet;1
100;3;/* If an order is available on the carrier */
SELECT 
 tblOrderPos.StepNo,
 tblOrderPos.ONo,
 tblOrderPos.OPos,
 tblOrderPos.WPNo,
 tblOrderPos.ResourceID,
 tblOrderPos.OpNo,
 tblOrderPos.MainOPos,
 tblOrder.CNo,
 tblOrderPos.PNo,
 tblStep.ErrorStepNo





FROM 
 tblCarrier 
;
 INNER JOIN tblOrder 
 ON tblCarrier.ONo = tblOrder.ONo
;
 INNER JOIN tblOrderPos 
 ON tblCarrier.ONo = tblOrderPos.ONo AND 
 tblCarrier.OPos = tblOrderPos.OPos
;
;INNER JOIN tblStep 
 ON tblOrderPos.ONo = tblStep.ONo AND 
 tblOrderPos.OPos = tblStep.OPos AND 
 tblOrderPos.StepNo = tblStep.StepNo 






WHERE 
 tblOrderPos.ResourceID = #ResourceID AND 
 tblOrderPos.PlannedStart <= Now() AND 
 tblOrderPos.State < 10 AND
 tblOrder.Enabled AND
 NOT tblOrderPos.subOrderBlocked AND 
 tblCarrier.CarrierID = #CarrierID

UNION 

/* If no order is available on the carrier */
( 
;SELECT 
 tblOrderPos.StepNo, 
 tblOrderPos.ONo, 
 tblOrderPos.OPos, 
 tblOrderPos.WPNo, 
 tblOrderPos.ResourceID, 
 tblOrderPos.OpNo, 
 tblOrderPos.MainOPos, 
 tblOrder.CNo, 
 tblOrderPos.PNo, 
 tblStep.ErrorStepNo

 FROM 
 tblOrder 
;;
 INNER JOIN tblOrderPos
 ON tblOrder.ONo = tblOrderPos.ONo
;;
 INNER JOIN tblStep
 ON tblOrderPos.StepNo = tblStep.StepNo AND 
 tblOrderPos.OPos = tblStep.OPos AND 
 tblOrderPos.ONo = tblStep.ONo
;
 WHERE 
 tblOrderPos.ResourceID = #ResourceID AND 
 tblOrderPos.PlannedStart <= Now() AND 
 tblOrderPos.State < 10 AND 
 tblOrder.Enabled AND 
 NOT tblOrderPos.subOrderBlocked AND 
 tblStep.FirstStep = TRUE AND 
;;
 /* Check if carrier is not asssigned to order */
 (
 SELECT 
 COUNT(tblCarrier.ONo)
 FROM 
 tblCarrier
 WHERE 
 tblCarrier.CarrierID = #CarrierID AND 
 tblCarrier.ONo = 0 AND 
 tblCarrier.OPos = 0
 ) = 1;;
;
 




ORDER BY 
 tblOrderPos.PlannedStart,
 tblOrderPos.ONo,
 tblOrderPos.OPos
)
;0;1;get next operation  for carrier id;GetOpForCarrier;1
100;4;SELECT tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrderPos.MainOPos, tblOrder.CNo, tblOrderPos.PNo , tblStep.ErrorStepNo
FROM (tblOrder INNER JOIN tblOrderPos ON tblOrder.ONo = tblOrderPos.ONo) INNER JOIN tblStep ON (tblOrderPos.StepNo = tblStep.StepNo) AND (tblOrderPos.OPos = tblStep.OPos) AND (tblOrderPos.ONo = tblStep.ONo) 
WHERE (((tblOrderPos.ResourceID)=#ResourceID) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<10) AND ((tblOrder.Enabled)=True) AND ((tblOrderPos.subOrderBlocked)=False) AND ((tblStep.FirstStep)=True)) 
ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos; ;0;1;get first operation for resource
;GetFirstOpForRsc;1
100;5;SELECT tblBufferPos.BufPos, tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrder.CNo, tblOrderPos.PNo, tblStep.ErrorStepNo 

FROM (tblOrder INNER JOIN (tblBufferPos INNER JOIN tblOrderPos ON (tblBufferPos.OPos = tblOrderPos.OPos) AND (tblBufferPos.ONo = tblOrderPos.ONo)) ON (tblBufferPos.ONo = tblOrder.ONo) AND (tblOrder.ONo = tblOrderPos.ONo))INNER JOIN tblStep ON (tblOrderPos.StepNo = tblStep.StepNo) AND (tblOrderPos.OPos = tblStep.OPos) AND (tblOrderPos.ONo = tblStep.ONo) 

WHERE (((tblBufferPos.ResourceId)=#ResourceID) AND ((tblBufferPos.BufNo)=#BufNo) AND ((tblOrder.Release)<Now()));;0;1;get next order from buffer where time elapsed;GetOpForOrderInBuf (Prolog);1
100;6;SELECT tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrderPos.MainOPos, tblOrder.CNo, tblOrderPos.PNo, tblCarrier.CarrierID, IF( tblOrderPos.OpNo=210,1,IF(tblOrderPos.OpNo=211,2,0)) as StopperID, tblStep.ErrorStepNo

FROM (tblOrder INNER JOIN (tblOrderPos LEFT JOIN tblCarrier ON (tblOrderPos.OPos = tblCarrier.OPos) AND (tblOrderPos.ONo = tblCarrier.ONo)) ON tblOrder.ONo = tblOrderPos.ONo) INNER JOIN tblStep ON (tblOrderPos.StepNo = tblStep.StepNo) AND (tblOrderPos.OPos = tblStep.OPos) AND (tblOrderPos.ONo = tblStep.ONo) 

WHERE (((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.ONo)=#ONo) AND ((tblOrderPos.OPos)=#OPos) AND ((tblOrderPos.State)<90) AND ((tblOrder.Enabled)=True) AND ((tblOrderPos.subOrderBlocked)=False))

ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos;;0;1;get next operation for ONo and OPos;GetOpForONoOPos;1
100;7;SELECT tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrderPos.MainOPos, tblOrder.CNo, tblOrderPos.PNo, tblStep.ErrorStepNo 

FROM (tblOrder INNER JOIN tblOrderPos ON tblOrder.ONo = tblOrderPos.ONo) INNER JOIN tblStep ON (tblOrderPos.StepNo = tblStep.StepNo) AND (tblOrderPos.OPos = tblStep.OPos) AND (tblOrderPos.ONo = tblStep.ONo) 

WHERE (((tblOrderPos.ResourceID)=#ResourceID) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<10) AND ((tblOrder.Enabled)=True) AND ((tblOrderPos.subOrderBlocked)=False) AND ((tblOrderPos.OpNo) = #OpNo )) 

ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos; ;0;1;get next defined operation for resource;GetDefOpForRsc;1
100;8;SELECT tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrderPos.MainOPos, tblOrder.CNo, tblOrderPos.PNo 
FROM (tblStepParameter INNER JOIN (tblOrder INNER JOIN tblOrderPos ON tblOrder.ONo = tblOrderPos.ONo) ON (tblStepParameter.OPos = tblOrderPos.OPos) AND (tblStepParameter.ONo = tblOrderPos.ONo) AND (tblStepParameter.StepNo = tblOrderPos.StepNo)) INNER JOIN tblBufferPos ON tblStepParameter.Parameter = tblBufferPos.PNo 
WHERE (((tblOrderPos.ResourceID)=#ResourceID) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<10) AND ((tblOrder.Enabled)=True) AND ((tblOrderPos.subOrderBlocked)=False) AND ((tblBufferPos.ResourceId)=#ResourceID) AND ((tblStepParameter.ParameterNo)=1)) 
ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos;;0;1;get a operation for resource where the part is in a buffer available;GetOpPNoForBuf (Prolog);1
100;9;SELECT tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrderPos.MainOPos, tblOrder.CNo, tblOrderPos.PNo, tblOrderPos_1.PNo AS MainPNo FROM (tblOrder INNER JOIN (tblOrderPos INNER JOIN tblBufferPos ON (tblOrderPos.ResourceID = tblBufferPos.ResourceId) AND (tblOrderPos.OPos = tblBufferPos.OPos)) ON (tblOrder.ONo = tblOrderPos.ONo) AND (tblOrder.ONo = tblBufferPos.ONo)) LEFT JOIN tblOrderPos AS tblOrderPos_1 ON (tblOrderPos.ONo = tblOrderPos_1.ONo) AND (tblOrderPos.MainOPos = tblOrderPos_1.OPos) WHERE (((tblOrderPos.ResourceID)=#ResourceID) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<10) AND ((tblOrder.Enabled)=True) AND ((tblOrderPos.subOrderBlocked)=False) AND ((tblBufferPos.BufNo)=#BufNo) AND ((tblBufferPos.BufPos)=1) AND ((tblBufferPos.Type)=2)) ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos; ;0;1;get operation for next part in fifo;GetOpForFiFo;1
100;10;SELECT tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrderPos.MainOPos, tblOrder.CNo, tblOrderPos.PNo 
FROM tblStepParameter INNER JOIN (tblOrder INNER JOIN tblOrderPos ON tblOrder.ONo = tblOrderPos.ONo) ON (tblStepParameter.StepNo = tblOrderPos.StepNo) AND (tblStepParameter.OPos = tblOrderPos.OPos) AND (tblStepParameter.ONo = tblOrderPos.ONo) 
WHERE (((tblOrderPos.ResourceID)=#ResourceID) AND ((tblOrderPos.OpNo)=#OpNo) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<10) AND ((tblOrder.Enabled)=True) AND ((tblOrderPos.subOrderBlocked)=False) AND ((tblStepParameter.ParameterNo)=1) AND ((tblStepParameter.Parameter)=#PNo)) 
ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos;;0;1;Get next defined operation for a defined part for this resource;GetDefOpPNoForRsc (Prolog);1
100;11;SELECT tblBufferPos.BufPos, tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrder.CNo, tblOrderPos.PNo, tblBufferPos.BoxID, tblBufferPos.BufNo, tblBoxPos.BoxPNo
FROM ((tblOrder INNER JOIN tblOrderPos ON tblOrder.ONo = tblOrderPos.ONo) INNER JOIN (tblBufferPos INNER JOIN tblBoxPos ON (tblBufferPos.PNo = tblBoxPos.BoxPNo) AND (tblBufferPos.BoxID = tblBoxPos.BoxId)) ON (tblOrderPos.OPos = tblBoxPos.OPos) AND (tblOrderPos.ONo = tblBoxPos.ONo)) 
WHERE (((tblOrderPos.OpNo)<1000) AND ((tblBufferPos.ResourceId)=#ResourceID) AND ((tblBufferPos.BufNo)=#BufNo) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<10))
ORDER BY tblOrderPos.PlannedStart;
;0;1;get next operation from part in Box ;GetOpInBox;1
100;12;SELECT tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrderPos.MainOPos, tblOrder.CNo, tblOrderPos.PNo, tblStepParameter.Parameter, tblBufferPos.BufPos, tblBufferPos.TimeStamp, tblBufferPos.BufNo, tblBufferPos.BufPos, tblStep.FirstStep 
FROM (tblOrder INNER JOIN (tblBufferPos INNER JOIN (tblStepParameter INNER JOIN tblOrderPos ON (tblStepParameter.ONo = tblOrderPos.ONo) AND (tblStepParameter.OPos = tblOrderPos.OPos) AND (tblStepParameter.StepNo = tblOrderPos.StepNo)) ON CONVERT(tblBufferPos.PNo, char) = (tblStepParameter.Parameter)) ON tblOrder.ONo = tblOrderPos.ONo) INNER JOIN tblStep ON (tblStep.StepNo = tblStepParameter.StepNo) AND (tblStep.OPos = tblStepParameter.OPos) AND (tblStep.ONo = tblStepParameter.ONo) AND (tblOrderPos.OPos = tblStep.OPos) AND (tblOrderPos.ONo = tblStep.ONo) 
WHERE (((tblOrderPos.ResourceID)=#ResourceID) AND ((tblBufferPos.BufNo)=#BufNo) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<10) AND ((tblOrder.Enabled)=True) AND ((tblOrderPos.subOrderBlocked)=False) AND ((tblBufferPos.ResourceId)=#ResourceID) AND ((tblStep.FirstStep)=True)) 
ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos, tblBufferPos.TimeStamp;;0;1;get next possible Order for this Resource where Part is in this Buffer;getFirstOpPosForRscBuf;1
100;13;SELECT tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrderPos.MainOPos, tblOrder.CNo, tblOrderPos.PNo 
FROM (tblOrder INNER JOIN tblOrderPos ON tblOrder.ONo = tblOrderPos.ONo) INNER JOIN tblStep ON (tblOrderPos.StepNo = tblStep.StepNo) AND (tblOrderPos.OPos = tblStep.OPos) AND (tblOrderPos.ONo = tblStep.ONo) 
WHERE (((tblOrderPos.WPNo)=#WPNo) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<=10) AND ((tblOrder.Enabled)=True) AND ((tblOrderPos.subOrderBlocked)=False) AND ((tblStep.FirstStep)=True)) 
ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos; ;0;1;get first operation for operation Number;GetFirstOpForOPNo;1
100;14;SELECT tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrderPos.MainOPos, tblOrder.CNo, tblOrderPos.PNo, tblStepParameter.Parameter, tblBufferPos.BufPos, tblBufferPos.TimeStamp, tblBufferPos.BufNo, tblBufferPos.BufPos, tblStep.FirstStep



FROM (tblOrder INNER JOIN (tblBufferPos INNER JOIN (tblStepParameter INNER JOIN tblOrderPos ON (tblStepParameter.ONo = tblOrderPos.ONo) AND (tblStepParameter.OPos = tblOrderPos.OPos) AND (tblStepParameter.StepNo = tblOrderPos.StepNo)) ON CONVERT(tblBufferPos.PNo, char) = (tblStepParameter.Parameter)) ON tblOrder.ONo = tblOrderPos.ONo) INNER JOIN tblStep ON (tblStep.StepNo = tblStepParameter.StepNo) AND (tblStep.OPos = tblStepParameter.OPos) AND (tblStep.ONo = tblStepParameter.ONo) AND (tblOrderPos.OPos = tblStep.OPos) AND (tblOrderPos.ONo = tblStep.ONo) 


WHERE (((tblOrderPos.ResourceID)=#ResourceID) AND ((tblBufferPos.BufNo)=#BufNo) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<10) AND ((tblOrder.Enabled)=True) AND ((tblOrderPos.subOrderBlocked)=False) AND ((tblBufferPos.ResourceId)=#ResourceID) AND ((tblStep.FirstStep)=True)) AND (tblStep.OpNo = 202 OR tblStep.OpNo = #OpNo) 


ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos, tblBufferPos.TimeStamp;;0;1;get next possible order for this resource where a the part is in a defined buffer and the operation is the defined OpNo (special for TF);GetFirstOpForRscBufTF;1
100;15;SELECT tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrderPos.MainOPos, tblOrder.CNo, tblOrderPos.PNo, tblStepParameter.Parameter, tblBufferPos.BufPos, tblBufferPos.TimeStamp, tblBufferPos.BufNo, tblBufferPos.BufPos, tblStep.FirstStep, IF( tblOrderPos.OpNo=212,1,IF(tblOrderPos.OpNo=213,2,0)) as StopperID


FROM (tblOrder INNER JOIN (tblBufferPos INNER JOIN (tblStepParameter INNER JOIN tblOrderPos ON (tblStepParameter.ONo = tblOrderPos.ONo) AND (tblStepParameter.OPos = tblOrderPos.OPos) AND (tblStepParameter.StepNo = tblOrderPos.StepNo)) ON Convert(tblBufferPos.PNo, char) = (tblStepParameter.Parameter)) ON tblOrder.ONo = tblOrderPos.ONo) INNER JOIN tblStep ON (tblStep.StepNo = tblStepParameter.StepNo) AND (tblStep.OPos = tblStepParameter.OPos) AND (tblStep.ONo = tblStepParameter.ONo) AND (tblOrderPos.OPos = tblStep.OPos) AND (tblOrderPos.ONo = tblStep.ONo) 


WHERE (((tblOrderPos.ResourceID)=#ResourceID) AND ((tblBufferPos.BufNo)=1) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<10) AND ((tblOrder.Enabled)=True) AND ((tblOrderPos.subOrderBlocked)=False) AND ((tblBufferPos.ResourceId)=#ResourceID) AND ((tblStep.FirstStep)=True)) AND (tblStepParameter.ParameterNo=3) AND (tblStep.OpNo = 202 OR tblStep.OpNo = 211 + #StopperID) 


ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos, tblBufferPos.TimeStamp;;0;1;get a first operation that is for this Stopper position and the PNo is available;GetFirstOpForRscTF2;1
100;16;SELECT tblBufferPos.BufPos, tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrder.CNo, tblOrderPos.PNo, tblBufferPos.BoxID, tblBufferPos.BufNo, tblBoxPos.BoxPNo



FROM ((tblOrder INNER JOIN tblOrderPos ON tblOrder.ONo = tblOrderPos.ONo) INNER JOIN (tblBufferPos INNER JOIN tblBoxPos ON (tblBufferPos.PNo = tblBoxPos.BoxPNo) AND (tblBufferPos.BoxID = tblBoxPos.BoxId)) ON (tblOrderPos.OPos = tblBoxPos.OPos) AND (tblOrderPos.ONo = tblBoxPos.ONo)) 



WHERE (((tblOrderPos.OpNo)<1000) AND ((tblBufferPos.ResourceId)=#ResourceID) AND ((tblBufferPos.BufNo)=#BufNo) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<10) AND tblOrderPos.ResourceId= #ResourceID)

ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos;;0;1;get next operation from part in Box for defined rsc;GetOpInBoxForRsc;1
100;17;SELECT tblBufferPos.BufPos, tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrder.CNo, tblOrderPos.PNo, tblBufferPos.BoxID, tblBufferPos.BufNo, tblBoxPos.BoxPNo, tblBoxPos.BoxPos




FROM ((tblOrder INNER JOIN tblOrderPos ON tblOrder.ONo = tblOrderPos.ONo) INNER JOIN (tblBufferPos INNER JOIN tblBoxPos ON (tblBufferPos.PNo = tblBoxPos.BoxPNo) AND (tblBufferPos.BoxID = tblBoxPos.BoxId)) ON (tblOrderPos.OPos = tblBoxPos.OPos) AND (tblOrderPos.ONo = tblBoxPos.ONo)) 




WHERE (((tblOrderPos.OpNo)<1000) AND ((tblBufferPos.ResourceId)=#ResourceID) AND ((tblOrderPos.ResourceId)=#ResourceID) AND ((tblBufferPos.BufNo)=#BufNo) AND ((tblBufferPos.BufPos)=#BufPos) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<10))



ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos;;0;1;Give back the next order in time from a buffer position for Resource;GetOpInBufPosForRsc;1
100;18;SELECT tblBufferPos.BufPos, tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrder.CNo, tblOrderPos.PNo, tblBufferPos.BoxID, tblBufferPos.BufNo, tblBoxPos.BoxPNo






FROM ((tblOrder INNER JOIN tblOrderPos ON tblOrder.ONo = tblOrderPos.ONo) INNER JOIN (tblBufferPos INNER JOIN tblBoxPos ON (tblBufferPos.PNo = tblBoxPos.BoxPNo) AND (tblBufferPos.BoxID = tblBoxPos.BoxId)) ON (tblOrderPos.OPos = tblBoxPos.OPos) AND (tblOrderPos.ONo = tblBoxPos.ONo)) 






WHERE (((tblOrderPos.OpNo)<1000) AND ((tblBufferPos.ResourceId)=#ResourceID) AND ((tblBufferPos.BufNo)=#BufNo) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<10) AND tblOrderPos.ResourceId= #ResourceID AND tblOrderPos.OpNo=#OpNo)

ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos;;0;1;get next defined operation from part in Box for defined rsc;GetDefOpInBoxForRsc;1
100;19;SELECT tblBufferPos.BufPos, tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrder.CNo, tblOrderPos.PNo, tblBufferPos.BoxID, tblBufferPos.BufNo, tblBoxPos.BoxPNo

FROM ((tblOrder INNER JOIN tblOrderPos ON tblOrder.ONo = tblOrderPos.ONo) INNER JOIN (tblBufferPos INNER JOIN tblBoxPos ON (tblBufferPos.PNo = tblBoxPos.BoxPNo) 
AND (tblBufferPos.BoxID = tblBoxPos.BoxId)) ON (tblOrderPos.OPos = tblBoxPos.OPos) AND (tblOrderPos.ONo = tblBoxPos.ONo)) 

WHERE (((tblOrderPos.OpNo)<1000) 
AND ((tblBufferPos.ResourceId)=#ResourceID) 
AND ((tblBufferPos.BufNo)=#BufNo) 
AND ((tblBufferPos.BufPos)=#BufPos) 
AND ((tblOrderPos.PlannedStart)<=Now()) 
AND ((tblOrderPos.State)<10) 
AND ((tblOrderPos.ONo)=#ONo) 
AND ((tblOrderPos.OPos)=#OPos))


ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos;;0;1;Get Order in box in BufPos;GetONoOPosInBuf;1
100;20;SELECT tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrderPos.MainOPos, tblOrder.CNo, tblOrderPos.PNo, tblCarrier.CarrierID, IF( tblOrderPos.OpNo=210,1,IF(tblOrderPos.OpNo=211,2,0)) as StopperID
FROM tblOrder INNER JOIN (tblOrderPos LEFT JOIN tblCarrier ON (tblOrderPos.OPos = tblCarrier.OPos) AND (tblOrderPos.ONo = tblCarrier.ONo)) ON tblOrder.ONo = tblOrderPos.ONo
WHERE (((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.ONo)=#ONo) AND ((tblOrderPos.OPos)=#OPos) AND ((tblOrderPos.State)<=10) AND ((tblOrder.Enabled)=True) AND ((tblOrderPos.subOrderBlocked)=False));;0;1;get started operation for ONo OPos (recalculate parameters);reGetOpForONoOPos;1
100;25;SELECT tblOrderPos.StepNo, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrderPos.MainOPos, tblOrder.CNo, tblOrderPos.PNo, tblStepParameter.Parameter, tblBufferPos.BufPos, tblBufferPos.TimeStamp, tblBufferPos.BufNo, tblBufferPos.BufPos, tblStep.FirstStep, IF( tblOrderPos.OpNo=212,1,IF(tblOrderPos.OpNo=213,2,0)) as StopperID, tblStep.ErrorStepNo


FROM (tblOrder INNER JOIN (tblBufferPos INNER JOIN (tblStepParameter INNER JOIN tblOrderPos ON (tblStepParameter.ONo = tblOrderPos.ONo) AND (tblStepParameter.OPos = tblOrderPos.OPos) AND (tblStepParameter.StepNo = tblOrderPos.StepNo)) ON CAST(tblBufferPos.PNo as CHAR) = (tblStepParameter.Parameter)) ON tblOrder.ONo = tblOrderPos.ONo) INNER JOIN tblStep ON (tblStep.StepNo = tblStepParameter.StepNo) AND (tblStep.OPos = tblStepParameter.OPos) AND (tblStep.ONo = tblStepParameter.ONo) AND (tblOrderPos.OPos = tblStep.OPos) AND (tblOrderPos.ONo = tblStep.ONo) 


WHERE (((tblOrderPos.ResourceID)=#ResourceID) AND ((tblBufferPos.BufNo)=1) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<10) AND ((tblOrder.Enabled)=True) AND ((tblOrderPos.subOrderBlocked)=False) AND ((tblBufferPos.ResourceId)=#ResourceID)) AND (tblStepParameter.ParameterNo=3) AND (tblStep.OpNo = 202 OR tblStep.OpNo = 211 + #StopperID) 


ORDER BY tblOrderPos.PlannedStart, tblOrderPos.ONo, tblOrderPos.OPos, tblBufferPos.TimeStamp;;0;1;get operation that is for this Stopper and the PNo is available;GetOpForASRS;1
100;30;SELECT tblOrder.ONo, tblOrder.CNo FROM tblOrder WHERE (((tblOrder.State)<90) AND ((tblOrder.ONo)=#ONo));;0;0;get info for ONo (exist the order?);OrderInfo;1
100;31;SELECT tblCustomer.FirstName, tblCustomer.LastName, tblCustomer.Company FROM tblOrder INNER JOIN tblCustomer ON tblOrder.CNo = tblCustomer.CNo WHERE (((tblOrder.ONo)=#ONo));;0;13;get name and company from customer for ONo;GetCustomerInfo;1
100;32;SELECT tblStep.Description AS OrderDes, tblParts.Description AS PartDes, tblStepParameter.Parameter 

FROM tblOrderPos INNER JOIN (tblParts INNER JOIN (tblStep INNER JOIN tblStepParameter ON (tblStep.StepNo = tblStepParameter.StepNo) AND (tblStep.OPos = tblStepParameter.OPos) AND (tblStep.ONo = tblStepParameter.ONo)) ON CAST(tblParts.PNo) as CHAR = (tblStepParameter.Parameter)) ON (tblOrderPos.StepNo = tblStep.StepNo) AND (tblOrderPos.OPos = tblStep.OPos) AND (tblOrderPos.ONo = tblStep.ONo) 

WHERE (((tblOrderPos.ONo)=#ONo) AND ((tblOrderPos.OPos)=#OPos) AND ((tblStepParameter.ParameterNo)=2));;0;15;Get text  that is shown on the manual workplace;GetTextForManWP;1
100;33;SELECT tblStep.Description, tblOrderPos.ONo, tblOrderPos.OPos FROM tblOrderPos INNER JOIN tblStep ON (tblOrderPos.StepNo = tblStep.StepNo) AND (tblOrderPos.OPos = tblStep.OPos) AND (tblOrderPos.ONo = tblStep.ONo) WHERE (((tblOrderPos.ONo)=#ONo) AND ((tblOrderPos.OPos)=#OPos));;0;22;get the step description;getStepDescription;1
100;41;SELECT tblFinOrder.ONo, tblFinOrder.Start, tblFinOrder.End, tblFinOrder.CNo, tblCustomer.Company, Count(tblFinOrderPos.OPos) AS PosCount 
FROM (tblFinOrder INNER JOIN tblCustomer ON tblFinOrder.CNo = tblCustomer.CNo) INNER JOIN tblFinOrderPos ON tblFinOrder.ONo = tblFinOrderPos.ONo GROUP BY tblFinOrder.ONo, tblFinOrder.Start, tblFinOrder.End, tblFinOrder.CNo, tblCustomer.Company, tblFinOrderPos.MainOPos HAVING (((tblFinOrder.ONo)=#ONo) AND ((tblFinOrderPos.MainOPos)=0));;0;10;Get infos for fin order;GetFinOrder;1
100;43;SELECT tblFinOrderPos.ONo, tblFinOrderPos.OPos, tblFinOrderPos.PNo, tblFinStepParameter.Parameter FROM tblFinOrderPos INNER JOIN tblFinStepParameter ON (tblFinOrderPos.OPos = tblFinStepParameter.OPos) AND (tblFinOrderPos.ONo = tblFinStepParameter.ONo) WHERE (((tblFinOrderPos.ONo)=#ONo) AND ((tblFinOrderPos.OPos)=#OPos) AND ((tblFinOrderPos.MainOPos)>0)) ORDER BY tblFinStepParameter.StepNo, tblFinStepParameter.ParameterNo; ;0;1;get all parameters for SubPos in Fin Orders;GetParSubPosFin;1
100;47;SELECT
FROM (SELECT tblStepParameter.Parameter FROM tblOrder INNER JOIN (tblOrderPos INNER JOIN tblStepParameter ON (tblOrderPos.OPos=tblStepParameter.OPos) AND (tblOrderPos.ONo=tblStepParameter.ONo) AND (tblOrderPos.StepNo=tblStepParameter.StepNo)) ON tblOrder.ONo=tblOrderPos.ONo 
WHERE (((tblOrderPos.ResourceID)=#ResourceID)AND ((tblOrderPos.OpNo)=502) AND ((tblOrderPos.PlannedStart)<=Now()) AND ((tblOrderPos.State)<10) AND ((tblOrder.Enabled)=True) AND ((tblOrderPos.subOrderBlocked)=False) AND ((tblStepParameter.ParameterNo)=1)) GROUP BY tblStepParameter.Parameter 
ORDER BY tblStepParameter.Parameter) AS Result1 LIMIT #Aux1Int
ORDER BY Result1.Parameter DESC LIMIT 1;;0;1;get a BoxPNo for manual boxing at manual dock . With Aux1Int we can select between the boxes;GetBoxPNoForManDock;1
100;100;SELECT tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.PNo, tblOrderPos.OpNo, tblOrderPos.StepNo, tblOrderPos.WPNo
FROM tblOrder INNER JOIN tblOrderPos ON tblOrder.ONo = tblOrderPos.ONo
WHERE (((tblOrder.Enabled)=True) AND ((tblOrderPos.PlannedStart)<Now()));;0;0;is any order available that can be started now;GetOldestOrder;1
100;101;#ResourceID #BufNo #Aux1Int;0;1;special hard coded message for Prolog that gives a order back that can deliverd
ResourceID Table, BufNo for ask Buffer, Aux1Int for deliveryBufer;PL_GetOrderToDeliver;1
100;110;SELECT tblStepParameter.Parameter

FROM ((tblOrderPos INNER JOIN tblStep ON (tblOrderPos.StepNo = tblStep.StepNo) AND (tblOrderPos.StepNo = tblStep.StepNo) AND (tblOrderPos.OPos = tblStep.OPos) AND (tblOrderPos.ONo = tblStep.ONo)) INNER JOIN tblStepParameter ON (tblStep.StepNo = tblStepParameter.StepNo) AND (tblStep.OPos = tblStepParameter.OPos) AND (tblStep.ONo = tblStepParameter.ONo)) INNER JOIN tblOperationParameter ON (tblStepParameter.ParameterNo = tblOperationParameter.ParameterNo) AND (tblStep.OpNo = tblOperationParameter.OpNo)

WHERE (((tblOperationParameter.DataType)=3) AND ((tblOrderPos.ONo)=#ONo) AND ((tblOrderPos.OPos)=#OPos));;0;23;get multiple string parameter;GetStringPar;1
100;111;SELECT tblStep.FreeString, tblStep.StepNo, tblStep.ONo, tblStep.OPos
FROM tblOrderPos INNER JOIN tblStep ON (tblOrderPos.ONo = tblStep.ONo) AND (tblOrderPos.OPos = tblStep.OPos) AND (tblOrderPos.StepNo = tblStep.StepNo) AND (tblOrderPos.StepNo = tblStep.StepNo)
WHERE (((tblOrderPos.ONo)=#ONo) AND ((tblOrderPos.OPos)=#OPos));;0;24;get the free string for the actual order field defined as parameter will be replaced;getFreeString;1
101;1;#ONo #OPos #StepNo;4;0;set parameters on runtime;setPar;1
101;2;#PNo #WPNo #Aux1Int;0;0;write and start a new Order and Give ONo back
Aux1Int = Value of Parts;SetNewOrder;1
101;3;#PNo #WPNo #Aux1Int;20;0;write and start a new Order and Give ONo back
StartDT Format = "JJJJMMTThhmmss";SetNewOrderDT;1
101;4;#PNo #WPNo #Aux1Int;0;0;write and start a new Order and Give ONo back
Aux1Int = Value of Parts;PlanNewOrder;1
101;5;;0;0;Disposition (slow);Dispo;1
101;6;#ONo #CNo #Aux1Int;19;0;set a custom order with changable Parameters in additional String;SetCustomOrder;1
101;9;UPDATE tblOrder SET tblOrder.Enabled = TRUE
WHERE tblOrder.ONo=#ONo;;0;0;enable a planned order for ONo;EnableOrder;1
101;10;UPDATE tblOrderPos SET tblOrderPos.Start = If(tblOrderPos.State=0,NOW(), tblOrderPos.Start), tblOrderPos.State = 10 



WHERE tblOrderPos.ONo=#ONo AND tblOrderPos.OPos=#OPos;;0;0;operation start;OpStart;1
101;15;UPDATE tblOrderPos SET tblOrderPos.State = 1 WHERE tblOrderPos.ONo=#ONo AND tblOrderPos.OPos=#OPos;;0;0;reset start operation;OpReset;1
101;20;#ONo #OPos #CarrierID #Aux1DInt;0;0;operation end
#Aux1DInt = StaffID;OpEnd;1
101;21;#ONo #OPos;0;0;End Order Position if error >=1 then end with error if not end with order Ok;EndOPos;1
101;30;UPDATE tblStep SET tblStep.ElectricEnergyReal= #Aux1DInt, tblStep.CompressedAirReal= #Aux2DInt

WHERE tblStep.ONo=#ONo AND tblStep.OPos=#OPos AND tblStep.StepNo=#StepNo;;0;0;write energy data for each step;WriteEnergyData;1
101;40;#ONo #OPos;0;0;set a alternative resource with the same operation or with a alternative operation;SetAltRsc;1
101;50;UPDATE tblStepParameter SET Parameter = '#String'
WHERE (ONo = #ONo and OPos = #OPos and StepNo = #StepNo and ParameterNo = #Aux1Int);25;0;write string parameter to actual order
Aux1Int = ParameterNo;SetStrPar;1
101;100;#BoxPNo #BoxID;0;0;BookOrdersToEmptyBox;BookOrdersToEmptyBox;1
110;1;;11;12;get shunt for target resource;GetShuntForTarget;1
150;1;SELECT BufPos, PNo, ONo, OPos, PalletID FROM tblBufferPos WHERE ResourceId=#ResourceID AND BufNo=#BufNo;;0;2;get all BufPos for defined BufNo and resource;GetBufForBufNo;1
150;2;SELECT tblBufferPos.BufNo, tblBufferPos.BufPos, tblBufferPos.PNo, tblBufferPos.ONo, tblBufferPos.OPos, tblBufferPos.PalletID, tblBufferPos.BoxID FROM tblBufferPos WHERE (((tblBufferPos.ResourceId)=#ResourceID)) ORDER BY tblBufferPos.BufNo, tblBufferPos.BufPos;;0;8;get all BufPos for all BufNos from defined resource;GetBufForRsc;1
150;3;SELECT tblBufferPos.BufPos, tblBufferPos.PNo, tblBufferPos.ONo, tblBufferPos.OPos, tblBufferPos.PalletID, tblOrderPos.ResourceID

FROM tblOrderPos RIGHT JOIN tblBufferPos ON (tblOrderPos.OPos = tblBufferPos.OPos) AND (tblOrderPos.ONo = tblBufferPos.ONo)

WHERE (((tblBufferPos.ResourceId)=#ResourceID) AND ((tblBufferPos.BufNo)=#BufNo))

ORDER BY tblOrderPos.PlannedStart;;0;21;get all buffers for spec. rsc and buf with next rsc;GetBufRscForBufNo;1
150;5;SELECT tblBufferPos.ResourceId, tblBufferPos.BufNo, tblBufferPos.BufPos, tblBufferPos.PNo, tblBufferPos.ONo, tblBufferPos.OPos, tblBufferPos.PalletID, tblBufferPos.BoxID, tblBufferPos.PNo AS BoxPNo, tblBufferPos.Quantity AS Aux1Int 

FROM tblBufferPos 

WHERE (((tblBufferPos.ResourceId)=#ResourceID) AND ((tblBufferPos.BufNo)=#BufNo) AND ((tblBufferPos.BufPos)=#BufPos));;0;0;get buffer of defined BufPos;GetBufPos;1
150;6;SELECT tblBufferPos.ResourceId, tblBufferPos.BufNo, tblBufferPos.BufPos, tblBufferPos.PNo, tblBufferPos.PNo as BoxPNo, tblBufferPos.ONo, tblBufferPos.OPos, tblBufferPos.PalletID, tblBufferPos.BoxID, If(tblBoxPos.PNo
=#PNo,Count(tblBoxPos.PNo),0) AS Aux1Int 

FROM tblBufferPos, tblBoxPos GROUP BY tblBufferPos.ResourceId, tblBufferPos.BufNo, tblBufferPos.BufPos, tblBufferPos.PNo, tblBufferPos.ONo, tblBufferPos.OPos, tblBufferPos.PalletID, tblBufferPos.BoxID, tblBufferPos.PNo, tblBoxPos.BoxId, tblBoxPos.BoxPNo, tblBoxPos.PNo HAVING (((tblBufferPos.ResourceId)=#ResourceID) AND ((tblBufferPos.BufNo)=#BufNo) AND ((tblBufferPos.BufPos)=#BufPos) AND ((tblBoxPos.BoxId)=tblBufferPos.BoxID) AND ((tblBoxPos.BoxPNo)=tblBufferPos.PNo)) 

ORDER BY If(tblBoxPos.PNo=#PNo,Count(tblBoxPos.PNo),0) DESC; ;0;0;get count of defined PNo in Box at BufPos;GetPNoCntFromBox;1
150;10;SELECT BufPos 
FROM tblBufferPos 
WHERE PNo=#PNo AND ONo=#ONo AND OPos=#OPos AND ResourceId=#ResourceID AND BufNo=#BufNo
ORDER BY TimeStamp ASC;0;0;get Buffer for ONo, OPos, PNo;GetBufPosForONoOPosPNo;1
150;11;SELECT tblBufferPos.BufPos, tblOrderPos.ONo, tblOrderPos.OPos, tblOrderPos.WPNo, tblOrderPos.StepNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrderPos.PNo FROM tblBufferPos, (tblPallet INNER JOIN tblOrder ON tblPallet.ONo = tblOrder.ONo) INNER JOIN tblOrderPos ON (tblPallet.ONo = tblOrderPos.ONo) AND (tblPallet.OPos = tblOrderPos.OPos) AND (tblOrder.ONo = tblOrderPos.ONo) WHERE (((tblOrder.Release)>Now()) AND ((tblPallet.PalletID)=#PalletID) AND ((tblBufferPos.ResourceId)=#ResourceID) AND ((tblBufferPos.BufNo)=#BufNo) AND ((tblBufferPos.ONo)=0) AND ((tblBufferPos.OPos)=0) AND ((tblBufferPos.PNo)=0));;0;0;get free BufPos if Part has to be stored;GetBufPosIfStore;1
150;12;SELECT BufPos FROM tblBufferPos WHERE PNo<>#PNo AND PNo>0 AND ONo=0 AND OPos=0 AND ResourceId=#ResourceID AND BufNo=#BufNo;0;0;get the BufPos for a part without any order where PNo not equal PNo of query;GetBufPosPNoNe;1
150;13;SELECT tblBufferPos.BufPos, tblBufferPos.PNo, tblBufferPos.ONo, tblBufferPos.OPos, tblBufferPos.BufNo, tblBufferPos.ResourceId FROM tblBufferPos LEFT JOIN tblPNoGroup ON tblBufferPos.Zone = tblPNoGroup.Id WHERE (((tblBufferPos.PNo)=0) AND ((tblBufferPos.ONo)=0) AND ((tblBufferPos.OPos)=0) AND ((tblBufferPos.ResourceId)=#ResourceID) AND ((tblBufferPos.BufNo)=#BufNo) AND ((tblPNoGroup.PNo)=#PNo)) OR (((tblBufferPos.PNo)=0) AND ((tblBufferPos.ONo)=0) AND ((tblBufferPos.OPos)=0) AND((tblBufferPos.ResourceId)=#ResourceID) AND ((tblBufferPos.BufNo)=#BufNo) AND ((tblBufferPos.Zone)=0));;0;0;get free BufPos for a PNo with the right zones;GetBufPosForPNo;1
150;14;SELECT BufPos FROM tblBufferPos WHERE PNo <> 0 AND ONo=#ONo AND OPos=#OPos AND ResourceId=#ResourceID AND BufNo=#BufNo;0;0;get Buffer for ONo, OPos where PNo <> 0;GetBufForONoOPos;1
150;16;SELECT PNo as Parameter 
FROM tblBufferPos 
WHERE ResourceId=#ResourceID AND BufNo=#BufNo AND BufPos >= #BufPos Order By BufPos ;;0;1;get parts in buf from BufPos (Ciros);getPartsInBufCiros;1
150;20;SELECT tblBufferPos.BufNo, tblBufferPos.BufPos, tblBufferPos.PNo, tblBufferPos.ONo, tblBufferPos.OPos, tblBufferPos.ResourceId
FROM tblAgvDocked INNER JOIN tblBufferPos ON tblAgvDocked.AgvId = tblBufferPos.ResourceId
WHERE (((tblAgvDocked.ResourceId)=#ResourceID));;0;0;get buffer from the docked AGV;GetBufDockedAgv;1
150;50;SELECT tblPallet.PalletID, tblPallet.ONo, tblPallet.OPos, tblPallet.PNo, tblOrder.Release, tblOrderPos.StepNo, tblOrderPos.ResourceID, tblOrder.CNo, tblOrderPos.Start, tblOrderPos.OpNo
FROM (tblPallet INNER JOIN tblOrder ON tblPallet.ONo = tblOrder.ONo) INNER JOIN tblOrderPos ON (tblOrderPos.OPos = tblPallet.OPos) AND (tblOrder.ONo = tblOrderPos.ONo) 
WHERE (((tblPallet.PalletID)=#PalletID))
UNION SELECT tblPallet.PalletID, tblPallet.ONo, tblPallet.OPos, tblPallet.PNo, tblFinOrder.Release, tblFinOrderPos.StepNo, tblFinOrderPos.ResourceID, tblFinOrder.CNo, tblFinOrderPos.Start, tblFinOrderPos.OpNo 
FROM (tblPallet INNER JOIN tblFinOrder ON tblPallet.ONo = tblFinOrder.ONo) INNER JOIN tblFinOrderPos ON (tblFinOrderPos.OPos = tblPallet.OPos) AND (tblFinOrder.ONo = tblFinOrderPos.ONo) 
WHERE (((tblPallet.PalletID)=#PalletID));0;5;get information for pallet;GetPalletInfo;1
150;60;SELECT tblOrderPos.StepNo, tblCarrier.ONo, tblCarrier.OPos, tblOrderPos.WPNo, tblOrderPos.ResourceID, tblOrderPos.OpNo, tblOrderPos.MainOPos, tblCarrier.PNo, tblCarrier.CarrierID FROM tblCarrier LEFT JOIN tblOrderPos ON (tblCarrier.OPos = tblOrderPos.OPos) AND (tblCarrier.ONo = tblOrderPos.ONo) WHERE (((tblCarrier.CarrierID)=#CarrierID));;0;0;get info abou the carrier and the order;GetCarrierInfo;1
150;61;SELECT
 tblCarrier.CarrierID

FROM
 tblCarrier

WHERE
 tblCarrier.ONo = #ONo
AND
 tblCarrier.OPos = #OPos;0;0;Get the CarrierID of a specific order. If the order is not assigned to any carrier, it returns with 0.;GetCarrierIdForONoOpos;1
150;70;SELECT tblBoxDef.BoxPNo, tblBufferPos.BoxID, tblBoxPos.PNo, tblBoxPos.BoxPos FROM tblBufferPos INNER JOIN (tblBoxPos INNER JOIN tblBoxDef ON tblBoxPos.BoxPNo = tblBoxDef.BoxPNo) ON (tblBufferPos.BoxID = tblBoxPos.BoxId) AND (tblBufferPos.PNo = tblBoxDef.BoxPNo) WHERE (((tblBufferPos.ResourceId)=#ResourceID) AND ((tblBufferPos.BufNo)=#BufNo) AND ((tblBufferPos.BufPos)=#BufPos) AND ((tblBoxPos.PNo)<>#PNo)) ORDER BY tblBoxPos.BoxPos;;0;0;get a Position for a defined part in the Box in the buffer;GetBoxPosFromBuf;1
150;71;SELECT tblBoxPos.BoxPos, tblBoxPos.ONo, tblBoxPos.OPos, tblBoxPos.PNo, tblBox.ONo AS Aux1DInt FROM tblBoxPos INNER JOIN tblBox ON (tblBoxPos.BoxId = tblBox.BoxID) AND (tblBoxPos.BoxPNo = tblBox.BoxPNo) WHERE (((tblBoxPos.BoxPNo)=#BoxPNo) AND ((tblBoxPos.BoxId)=#BoxID)) ;;0;9;get all positions of the box;GetBoxPosAll;1
150;72;SELECT tblBoxPos.BoxPos, tblBoxPos.ONo, tblBoxPos.OPos, tblBoxPos.PNo, tblBox.ONo AS Aux1DInt, tblOrderPos.ResourceID FROM tblOrderPos INNER JOIN (tblBoxPos INNER JOIN tblBox ON (tblBoxPos.BoxPNo = tblBox.BoxPNo) AND (tblBoxPos.BoxId = tblBox.BoxID)) ON (tblOrderPos.OPos = tblBoxPos.OPos) AND (tblOrderPos.ONo = tblBoxPos.ONo) WHERE (((tblBoxPos.BoxPNo)=#BoxPNo) AND ((tblBoxPos.BoxId)=#BoxID));;0;16;get all positions of the box + next resource;GetBoxPosAllRsc;1
150;73;SELECT COUNT(*) as Aux1Int



FROM tblBoxPos 



WHERE PNo<>0 AND BoxId = #BoxID AND BoxPNo = #BoxPNo ;0;0;Get the number of parts in a defined box;GetNoPartsInBox;1
150;74;#ResourceID #BufNo #BufPos;0;1;GetPartNumInBoxForIslandOfRsc;GetPartNumInBoxForIslandOfRsc;1
151;1;#ResourceID #BufNo #PNo #ONo #OPos #PalletID #BoxID;0;0;add a new position to a FIFO buffer;AddToFiFo;1
151;2;SELECT tblBufferPos.ResourceId, tblBufferPos.BufNo, tblBufferPos.BufPos, tblBufferPos.PNo, tblBufferPos.ONo, tblBufferPos.OPos, tblBufferPos.PalletID, tblBufferPos.BoxID, tblBufferPos.PNo AS BoxPNo FROM tblBufferPos WHERE (((tblBufferPos.ResourceId)=#ResourceID) AND ((tblBufferPos.BufNo)=#BufNo) AND ((tblBufferPos.BufPos)=#BufPos));;0;0;get a part from the FIFO from defined pos and delete it 1=oldest Part;DelFifoPos;1
151;5;;6;0;move a buffer from source to target (for buffer and FIFO);MoveBuf;1
151;10;UPDATE tblBufferPos SET PNo = #PNo, ONo = #ONo, OPos = #OPos, TimeStamp = Now(), PalletID = #PalletID, BoxID = #BoxID, Booked = False, Quantity = #Aux1Int



WHERE ResourceId=#ResourceID AND BufNo=#BufNo AND BufPos=#BufPos;0;0;write in buffer; Aux1Int = Qunatity of a stack buffer;SetBufPos;1
151;11;UPDATE tblBufferPos SET tblBufferPos.Quantity = If(Quantity<=1 ,0,Quantity-1), tblBufferPos.PNo = If(Quantity<=1 ,0,PNo) , tblBufferPos.ONo = If(Quantity<=1 ,0,ONo), tblBufferPos.OPos = If(Quantity<=1 ,0,OPos), TimeStamp = now()
WHERE (((tblBufferPos.ResourceId)=#ResourceID) AND ((tblBufferPos.BufNo)=#BufNo) AND ((tblBufferPos.BufPos)=#BufPos));;0;0;Clear a normal Buffer and reduce one from a Stack Buffer;DelBufPos;1
151;12;UPDATE tblBufferPos SET PNo =0, ONo = 0, OPos = 0, TimeStamp = Now(), PalletID = 0, BoxID = 0


WHERE ResourceId=#ResourceID AND BufNo=#BufNo;0;0;delete all positions of a defined buffer;DelBuf;1
151;15;UPDATE tblBufferPos SET Booked = True

WHERE ResourceId=#ResourceID AND BufNo=#BufNo AND BufPos=#BufPos;0;0;block a defined BufPos;BlockBufPos;1
151;16;UPDATE tblBufferPos SET Booked = False


WHERE ResourceId=#ResourceID AND BufNo=#BufNo AND BufPos=#BufPos;0;0;unlock a defined Buf pos;UnBlockBufPos;1
151;50;UPDATE tblPallet SET ONo = #ONo, OPos = #OPos, PNo = #PNo WHERE PalletID=#PalletID ;0;0;set order to pallet;SetPallet;1
151;60;UPDATE tblCarrier SET ONo = #ONo, OPos = #OPos, PNo = #PNo WHERE CarrierID=#CarrierID ;0;0;set order to carrier;SetCarrier;1
151;70;UPDATE tblBox INNER JOIN tblBoxPos ON (tblBox.BoxID = tblBoxPos.BoxId) AND (tblBox.BoxID = tblBoxPos.BoxId) AND (tblBox.BoxPNo = tblBoxPos.BoxPNo) SET tblBoxPos.PNo = #PNo, tblBox.ONo = 0, tblBoxPos.ONo = 0, tblBoxPos.OPos = 0 WHERE (((tblBoxPos.BoxId)=#BoxID) AND ((tblBoxPos.BoxPNo)=#BoxPNo));;0;0;fill all box positions with one sort of part and del the actual order;FillBox;1
151;71;UPDATE tblBoxPos, tblBox SET tblBoxPos.PNo = #PNo, tblBoxPos.ONo = #ONo, tblBoxPos.OPos = #OPos, tblBox.ONo = #ONo WHERE tblBoxPos.BoxId=#BoxID AND tblBoxPos.BoxPNo=#BoxPNo AND tblBoxPos.BoxPos=#BoxPos AND tblBox.BoxId=#BoxID AND tblBox.BoxPNo=#BoxPNo;;0;0;write part to box position;SetBoxPos;1
151;72;UPDATE tblBox SET tblBox.ONo = #ONo WHERE (((tblBox.BoxPNo)=#BoxPNo) AND ((tblBox.BoxID)=#BoxID));;0;0;book box to a specific ONo;SetBoxONo;1
200;5;SELECT PNo, Description 

FROM tblParts 

WHERE Type = 99;0;18;get all parts signed as unknown;getUnknownParts (old);1
200;20;SELECT tblBufferPos.ResourceId, tblBufferPos.BufNo, tblBufferPos.BufPos, tblBuffer.BeltNo FROM tblBuffer INNER JOIN tblBufferPos ON (tblBuffer.BufNo = tblBufferPos.BufNo) AND (tblBuffer.ResourceId = tblBufferPos.ResourceId) WHERE (((tblBuffer.Type)=10) AND ((tblBufferPos.PNo)=#PNo)) ORDER BY tblBufferPos.TimeStamp;;0;14;get a buffer where a Agv can get a defined Part;GetToAgvBufForPNo;1
200;21;NULL;0;14;get a buffer where a AGV can get a defined Part;GetToAGVBuf;1
201;1;UPDATE tblAgvDocked SET tblAgvDocked.ResourceId = #ResourceID
WHERE (((tblAgvDocked.AgvId)=#Aux1Int ));;0;0;write the actuall AGV Position
Aux1Int = AgvId;SetAgvPos;1
210;1;UPDATE tblStep AS b SET b.ResourceID = #ResourceID
WHERE (((b.StepNo)=#StepNo) AND ((b.ONo)=#ONo) AND ((b.OPos)=#OPos));;0;0;change the planned resource;changeRsc;1
